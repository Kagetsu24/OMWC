extends ../layout.pug
include ../mixins/buttons.pug

block content
    .container.text-center
        .row
            .col-sm
                if applicationsByCountry.length
                    each country in applicationsByCountry
                        h4= country.name

                        table.table.table-hover
                            thead
                                tr
                                    th Applicant
                                    th Total Votes
                                    th Voted by
                                    th
                            tbody
                                each application in country.captainApplications
                                    tr
                                        td= application.user.username
                                        td= application.captainVotes.length
                                        td
                                            each vote in application.captainVotes
                                                = vote.user.username + ' '
                                        td
                                            if (application.user.team && application.user.team.captainId === application.user.id)
                                                form(action="/admin/captainChoice/destroy", method="post")
                                                    input(type="hidden", name="applicationId" value=application.id)
                                                    +submit-button('Remove')

                                            //- If there's NOT any captain in the country
                                            else if !(country.captainApplications.find(a => a.user.team && a.user.team.captainId))
                                                form(action="/admin/captainChoice/store", method="post")
                                                    input(type="hidden", name="applicationId" value=application.id)
                                                    +submit-button('Choose')

                else
                    p No applications yet
